# 进程 上下文，内存

## 进程上下文

发生上下文切换的原因：1系统调用 2中断 3异常。 上下文代表程序代码，运行的数据等等。当程序加载完后，会先分配虚拟内存，构建虚拟内存地址和程序的映射关系，在运行的时候，如果发现页表里面没有对应的物理地址，那么就会发生缺页中断，进行物理地址分配，接着虚拟内存地址和物理内存地址进行映射关系

### 上下文切换和两个栈的关系：中断会驱动上下文切换

每个进程（线程）都有两个栈：用户栈和内核栈。当一个进程正在running的时候发生了中断，他就会变成下降进程，同时就绪态的进程会变成上升进程（进入cpu时间片），所以内核栈会保存过之前的现场信息。内核栈可以说是中断栈原因是，下降进程的信息（硬件上下文比如寄存器包括了现场：通用寄存器和pc）都会保存在内核栈，pcb有指针指向这个内核栈。

